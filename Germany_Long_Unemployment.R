################################################################################
##### MOVING AVERAGE (1) MODEL #################################################
################################################################################

{
  gufitLR <- dynlm(g_u ~  g_cpi + g_cpi_1)
  summary(gufitLR)
}

################################################################################
##### AUTOREGRESSIVE (1) MODEL #################################################
################################################################################

{
  ARgufitLR <- dynlm(g_u ~  g_cpi + g_u_1)
  summary(ARgufitLR)
}

################################################################################
##### AUTOREGRESSIVE MOVING AVERAGE (1,1) MODEL ################################
################################################################################

{
  ARMAgufitLR <- dynlm(g_u ~  g_cpi + g_u_1 + g_cpi_1)
  summary(ARMAgufitLR)
}

################################################################################
##### AUTOREGRESSIVE MOVING AVERAGE (2,2) MODEL ################################
################################################################################

{
  ARMA2gufitLR <- dynlm(g_u ~  g_cpi + g_u_1 + g_cpi_1 + g_u_2 + g_cpi_2)
  summary(ARMA2gufitLR)
}

################################################################################
##### AUTOREGRESSIVE MOVING AVERAGE (2,1) MODEL ################################
################################################################################

{
  ARMA21gufitLR <- dynlm(g_u ~  g_cpi + g_u_1 + g_cpi_1 + g_u_2 )
  summary(ARMA21gufitLR)
}

################################################################################
##### AUTOREGRESSIVE MOVING AVERAGE (1,2) MODEL ################################
################################################################################

{
  ARMA12gufitLR <- dynlm(g_u ~  g_cpi + g_u_1 + g_cpi_1 + g_cpi_2 )
  summary(ARMA12gufitLR)
}

################################################################################
##### AUTOREGRESSIVE (2) MODEL #################################################
################################################################################

{
  AR2gufitLR <- dynlm(g_u ~  g_cpi + g_cpi_1 + g_cpi_2 )
  summary(ARMA12gufitLR)
}

################################################################################
##### SELECTING BEST MODEL #####################################################
################################################################################

AIC(gufitLR, ARgufitLR, ARMAgufitLR) 
AIC(ARMA2gufitLR, ARMA21gufitLR, ARMA12gufitLR, AR2gufitLR)
BIC(gufitLR, ARgufitLR, ARMAgufitLR)
BIC(ARMA2gufitLR, ARMA21gufitLR, ARMA12gufitLR, AR2gufitLR)

# We choose ARMA(2,1) for the information criteria

################################################################################
##### HETEROSKEDASTICITY TEST ##################################################
################################################################################

bptest(ARMA21gufitLR, studentize = FALSE) 

################################################################################
##### ARCH TEST ################################################################
################################################################################

archTestLRg_u <- ArchTest(ARMA21gufitLR$residuals, lags = 2, demean = FALSE)
archTestLRg_u

################################################################################
##### F-STATISTIC DISTRIBUTION TEST ############################################
################################################################################

resettest(g_u ~  g_cpi + g_u_1 + g_cpi_1 + g_u_2) 

################################################################################
##### WALD TEST ################################################################
################################################################################

wald.test(Sigma = vcov(ARMA21gufitLR), b = coef(ARMA21gufitLR), Terms = 2:5)

################################################################################
##### DURBIN-WATSON TEST #######################################################
################################################################################

dwtest(ARMA21gufitLR)
Box.test(ARMA21gufitLR$residuals, type = "Ljung-Box", lag = 6)
Box.test(ARMA21gufitLR$residuals, type = "Box-Pierce", lag = 6) 
{
  x11()
  acf(ARMA21gufitLR$residuals)
}


